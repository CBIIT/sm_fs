<div class="row">
    <div class="col-12 d-flex">
        <h2 class="d-inline-block" id="filters-label">Filters</h2>
        <a [routerLink]="" (click)="showHideAdvanced()" class="ml-auto">Show Advanced Filters</a>
    </div>
</div>
<div class="row" role="group" aria-labelledby="filters-label">

    <div class="col-lg-4">
        <app-search-pool [(searchWithin)]="searchWithin" [grantSearch]="true"></app-search-pool>
    </div>

    <div class="col-lg-8">
        <lib-grantnumber-search-criteria></lib-grantnumber-search-criteria>
    </div>

    <div class="col-lg-3">
        <lib-fy-range [minYear]="2001" [maxYear]="2025" [(selectedValue)]="fyRange"></lib-fy-range>
    </div>
    
    <div class="col-lg-3">
        <lib-i2status-dropdown [(selectedValue)]="i2Status"></lib-i2status-dropdown>
    </div>

    <div class="col-lg-3">
        <div class="form-group">
            <label for="piName">PI</label>
            <input id="piName" type="text" class="form-control" [(ngModel)]="piName"/>
        </div>
    </div>

    <!-- START Advanced Filters -->

    <div class="col-lg-6" *ngIf="showAdvancedFilters">
        <lib-pdname-dropdown [(selectedValue)]="selectedPd" ></lib-pdname-dropdown>
    </div>

    <div class="col-lg-3" *ngIf="showAdvancedFilters">
        <lib-rfa-pa-dropdown [(selectedValue)]="selectRfaPa"></lib-rfa-pa-dropdown>
    </div>

    <div class="col-lg-3" *ngIf="showAdvancedFilters">
        <lib-ncab-daterange [(selectedValue)]="ncabRange"></lib-ncab-daterange>
    </div>

    <div class="col-lg-6" *ngIf="showAdvancedFilters">
        <lib-cancer-activities-dropdown  [(selectedValue)]="selectedCas"></lib-cancer-activities-dropdown>
    </div>

    <!-- END Advanced Filters -->

    <div class="col-lg-2 d-flex align-items-end justify-content-end ml-auto">
        <button class="btn btn-outline-secondary mr-2" (click)="clear()">Clear</button>
        <button class="btn btn-primary" (click)="search()">Search</button>
    </div>

    <div class="col-12">
        <hr/>
    </div>

</div> <!-- END Row -->

<div class="row">
    <div class="col-12">
        <h2>Results</h2>
        <p *ngIf="!grantList">No results to display. Try applying a filter above and clicking "Search."</p>
        <table #grantDt datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="row-border">
            <thead>
              <tr>
                <th>Grant Number</th>
                <th>Project Title</th>
                <th>I2 Status</th>
                <th>PI</th>
                <th>Institution</th>
                <th>FY</th>
                <th>NCAB Date</th>
                <th>Pctl</th>
                <th>PriScr</th>
                <th>CA</th>
                <th>PD</th>
                <th>Budget Start Date</th>
                <th>Existing Requests</th>
                <th>Action</th>
                <th>&nbsp;</th>
              </tr>
            </thead>
            <tbody>
            <tr *ngFor="let grant of grantList">
                <td><a href="{{grantViewerUrl+grant.applId}}" target="yourgrant">{{grant.fullGrantNum}}</a></td>
                <td>{{grant.projectTitle}}</td>
                <td>{{grant.applStatusGroupDescrip}}</td>
                <td><a href="mailto:{{grant.piEmail}}">{{grant.piFullName}}</a></td>
                <td>{{grant.orgName}}</td>
                <td>{{grant.fy}}</td>
                <td>{{grant.councilMeetingDate|formatNcabDate}}</td>
                <td>{{grant.irgPercentileNum}}</td>
                <td>{{grant.priorityScoreNum}}</td>
                <td><a [routerLink]="" ngbPopover="{{grant.cayCode|codeDescription:'CancerActivities'}}" triggers="mouseenter:mouseleave" placement="top">{{grant.cayCode}}</a></td>
                <td><a href="mailto:{{grant.pdEmailAddress}}">{{grant.roleUsageCode}}</a></td>
                <td>{{grant.budgetStartDate|date:'MM/dd/yyyy'}}</td>
                <td>{{grant.requestCount}}</td>
                <td><button class="btn btn-primary"  (click)="nextStep($event, grant)">Select</button></td>
                <td></td>
              </tr>
            </tbody>
          </table>
    </div>
</div>