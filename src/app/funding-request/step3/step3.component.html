<div class="row">

    <div class="col-lg-4" id="add-docs">
        <h2>Add Docs</h2>
        <p><small class="text-muted">You may upload Microsoft Word, Microsoft Excel, or Adobe Acrobat document(s) only.
                Note: If you upload MS Excel, make sure it contains only one worksheet per file in order to have it
                included in the submission package.
                Please upload only the documents that support the approval of this request. <b>Maximum File Size is 10
                    MB per file.</b></small></p>

        <div class="form-group">
            <label for="type">Type</label>
            <ng-select2 id="type" [(ngModel)]="selectedDocType" [allowClear]="true"
                (ngModelChange)="onDocTypeChange($event)">
                <option></option>
                <option *ngFor="let docType of DocTypes | async" [value]="docType.rvLowValue"> {{docType.rvLowValue}}
                </option>
            </ng-select2>
        </div>

        <div class="form-group">
            <label for="add-file" class="sr-only">Choose File</label>
            <input id="add-file" #inputFile type="file" accept=".doc,.docx,.xls,.xlsx,.pdf" [disabled]="disableFile"
                (change)="selectFiles($event)">
        </div>

        <div *ngIf="showJustification" class="form-group">
            <label for="file-description">Justification Text</label>
            <textarea class="form-control" maxlength="1000" id="file-description" [disabled]="disableJustification"
                rows="5" (change)="justificationOnChange()" [(ngModel)]="docDescription"></textarea>
            <span class="counter">{{ docDescription.length }}/1000</span>
        </div>

        <div class="d-flex w-100">
            <button class="btn btn-outline-secondary mr-2" (click)="reset()">Clear</button>
            <button class="btn btn-primary ml-auto" [disabled]="!selectedFiles && docDescription ===''"
                (click)="uploadFiles()">Add Doc</button>
        </div>


    </div><!-- END left col -->

    <div class="col-lg-8" id="submission-package">
        <ng-container cdkDropListGroup>
            <div class='wrapper'>
                <h2>Submission Package</h2>
                <h2>Included Content</h2>

                <div class="drop-well mb-3">

                    <div class="drag-item drag-item-locked" tabindex="0">
                        <span class="doc-name"> Cover Page </span>
                        <span class="doc-desc">(Automatically Generated)</span>
                        <div class="ml-auto">
                            <button class="btn btn-link btn-slim ml-1" title="View" (click)="downloadCoverSheet()"><i
                                    class="fas fa-eye" aria-hidden="true"></i></button>
                        </div>
                    </div>

                    <div *ngIf="justificationUploaded | async" class="drag-item drag-item-locked" tabindex="0">

                        <span class="doc-name">{{ justificationType == 'text' ? 'Justification' :
                            justificationFileName}}</span>
                        <span class="doc-desc">(Added by <a
                                href="mailto: {{justificationEnteredByEmail}}">{{justificationEnteredBy}}</a> on
                            {{justificationUploadedOn}})</span>
                        <div class="ml-auto">

                            <button *ngIf="justificationType === 'text'" class="btn btn-link btn-slim ml-2"
                                title="Edit"><i class="fas fa-pencil" aria-hidden="true"></i></button>
                            <button *ngIf="justificationType === 'text'" class="btn btn-link btn-slim ml-1" title="View"
                                (click)="open(justificationModal)"><i class="fas fa-eye" aria-hidden="true"></i></button>
                            <button *ngIf="justificationType !== 'text'" class="btn btn-link btn-slim ml-1" title="View"
                                (click)="downloadFile(justificationId, justificationFileName)"><i class="fas fa-eye" aria-hidden="true"></i></button>
                            <button class="btn btn-link btn-slim ml-2 btn-delete" title="Delete"
                                (click)="deleteJustification()"><i class="fas fa-trash" aria-hidden="true"></i></button>
                        </div>
                    </div>

                    <div *ngIf="!(justificationUploaded | async)" class="drag-item drag-item-placeholder drag-item-locked" tabindex="0">
                        <span class="doc-name">Justification</span>
                        <span class="doc-desc" [style.color]="'red'">Not Entered/Uploaded</span>
                    </div>


                    <div class="example-container" *ngFor="let lane of swimlanes">

                        <div id="includedId" *ngIf="lane.name==='Included Content'" class="min-height-5"
                            cdkDropList [cdkDropListData]="lane.array" (cdkDropListDropped)="drop($event)">

                            <div class="drag-item" cdkDrag *ngFor="let item of lane.array" tabindex="0">
                                <span class="doc-name">{{ item.docFilename }}</span>
                                <span *ngIf="item.docFilename === 'Summary Statement'" class="doc-desc">(Retrieved form
                                    IMPAC II)</span>
                                <span *ngIf="item.docFilename !== 'Summary Statement'" class="doc-desc">(Added by <a
                                        href="mailto: {{item.uploadByEmail}}">{{item.uploadByName}}</a> on
                                    {{item.createDate}})</span>
                                <div class="ml-auto">
                                    <button *ngIf="item.docFilename!=='Summary Statement'"
                                        class="btn btn-link btn-slim ml-2 btn-delete" title="Delete"
                                        (click)="deleteDoc(item.id, item.docType)"><i class="fas fa-trash"
                                            aria-hidden="true"></i></button>
                                    <button class="btn btn-link btn-slim ml-1" title="View"
                                        (click)="downloadFile(item.id, item.docFilename)"><i class="fas fa-eye"
                                            aria-hidden="true"></i></button>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
            </div>

            <div class='wrapper'>

                <h2>Excluded Content</h2>
                <div class="example-container" *ngFor="let lane of swimlanes">
                    <div *ngIf="lane.name === 'Excluded Content'">

                        <div id="excludedId" class="drop-well min-height-5" cdkDropList [cdkDropListData]="lane.array"
                            (cdkDropListDropped)="drop($event)">
                            <div class="drag-item" cdkDrag *ngFor='let item of lane.array' tabindex="0">
                                <span class="doc-name">{{ item.docFilename }}</span>
                                <span *ngIf="item.docFilename === 'Summary Statement'" class="doc-desc">(Retrieved form
                                    IMPAC II)</span>
                                <span *ngIf="item.docFilename !== 'Summary Statement'" class="doc-desc">(Added by <a
                                        href="mailto: {{item.uploadByEmail}}">{{item.uploadByName}}</a> on
                                    {{item.createDate}})</span>
                                <div class="ml-auto">

                                    <button class="btn btn-link btn-slim ml-1" title="View"
                                        (click)="downloadFile(item.id, item.docFilename)"><i class="fas fa-eye"
                                            aria-hidden="true"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </ng-container>
    </div>
</div>

<hr>
<div class="row">
    <div class="col-12 d-flex">
        <button class="btn btn-outline-secondary mr-auto" (click)="prevStep()">Previous</button>
        <button class="btn btn-outline-primary mr-2" (click)="downloadPackage()"><i class="far fa-file-pdf mr-1"
                aria-hidden="true"></i> View
            Package</button>
        <button class="btn btn-primary" (click)="nextStep()">Save and Continue</button>
    </div>
</div>

<ng-template #justificationModal let-modal>
    <div class="modal-header">
        <h2 class="modal-title h4 mb-0" id="i2group-title">Justification Text</h2>
        <button type="button" class="close"  (click)="modal.dismiss('')"><i class="fas fa-times" aria-label="close modal"></i></button>
     </div>
    <div class="modal-body">
        {{justificationText}}
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" (click)="modal.close()">Close</button>
    </div>
</ng-template>